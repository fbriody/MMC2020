---
title: "Using the Illinois Report Card Data to Teach Statistics"
subtitle: "MMC Conference of Workshops 2020"
author: "Frank Briody"
institute: "Prospect High School"
date: "2/1/2020"
output:
  xaringan::moon_reader:
    css: ["xaringan-themer.css", "fb.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
---
```{r xaringan-themer, include = FALSE}
#install.packages("devtools")
#background color as rgb rgb(.184,.306,.435, alpha = .005)
#devtools::install_github("gadenbuie/xaringanthemer")
library(xaringanthemer)
mono_light(
  base_color = "#2F4E6F",
  header_font_google = google_font("Josefin Sans"),
  text_font_google   = google_font("Montserrat", "300", "300i"),
  code_font_google   = google_font("Droid Mono")
)
#base_color = "#1c5253",
```

background-image: url(EDA_present_files/figure-html/draft.png)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(htmltools.dir.version = FALSE)

##Uncomment the lines below to install if necessary
##Installation is one-time 
#install.packages("tidyverse")
#install.packages("kableExtra")
#install.packages("scales")
#install.packages("DT")
#install.packages("ggalt")

#load packages
library(tidyverse)
library(kableExtra)
library(scales)
library(DT)
library(ggrepel)
library(ggalt) #for dumbbell plot

#theme_set(text = element_text(size=20))
theme_update(text = element_text(size=20))

phs_value <- function(unk) {
  x <- rc17 %>% 
    filter(SCHOOL_ID == "050162140170005")
  x[unk]
}

#make sure the path to rc17.txt is correct
rc17 <- read_fwf("~/Documents/rc17.txt", 
         fwf_cols(SCHOOL_ID	= c(1,15),
SCHOOL_TYPE_CODE=c(17,17),
SCHOOL_NAME=c(20,52),
DISTRICT_NAME=c(54,86),
CITY=c(88,104),
COUNTY=c(106,116),
DISTRICT_TYPE_CODE=c(118,118),
DISTRICT_SIZE_CODE=c(120,120),
DISTRICT_TYPE_NAME=c(122,132),
DISTRICT_SIZE_NAME=c(134,139),
SCHOOL_TYPE_NAME=c(141,151),
GRADES_IN_SCHOOL=c(153,183),
SCHOOL_WHITE_per=c(185,189),
SCHOOL_BLACK_per=c(191,195),
SCHOOL_HISPANIC_per=c(197,201),
SCHOOL_ASIAN_per=c(203,207),
SCHOOL_NATIVE_HAWAIIAN_OR_OTHER_PACIFIC_ISLANDER_per=c(209,213),
SCHOOL_NATIVE_AMERICAN_per=c(215,219),
SCHOOL_TWO_OR_MORE_RACES_per=c(221,225),
SCHOOL_TOTAL_ENROLLMENT=c(227,231),
LEP_SCHOOL_per=c(385,389),
IEP_SCHOOL_per=c(409,413),
LOWINCOME_SCHOOL_per=c(433,437),
HOMELESS_SCHOOL_per=c(457,461),
TOTAL_SCHOOL_DAYS_SCHOOL=c(481,483),
PARENTAL_INVOLVEMENT_SCHOOL_per=c(497,501),
ATTENDANCE_RATE_SCHOOL_perALL=c(521,525),
ATTENDANCE_RATE_SCHOOL_perMALE=c(545,549),
ATTENDANCE_RATE_SCHOOL_perFEMALE=c(569,573),
ATTENDANCE_RATE_SCHOOL_perWHITE=c(593,597),
ATTENDANCE_RATE_SCHOOL_perBLACK=c(617,621),
ATTENDANCE_RATE_SCHOOL_perHISPANIC=c(641,645),
ATTENDANCE_RATE_SCHOOL_perASIAN=c(665,669),
ATTENDANCE_RATE_SCHOOL_perNATIVE_HAWAIIAN_AND_OTHERS=c(689,693),
ATTENDANCE_RATE_SCHOOL_perNATIVE_AMERICAN=c(713,717),
ATTENDANCE_RATE_SCHOOL_perTWO_OR_MORE_RACES=c(737,741),
ATTENDANCE_RATE_SCHOOL_perLEP=c(761,765),
ATTENDANCE_RATE_SCHOOL_perMIGRANT=c(785,789),
ATTENDANCE_RATE_SCHOOL_perIEP=c(809,813),
ATTENDANCE_RATE_SCHOOL_perLOW_INCOME=c(833,837),
STUDENT_MOBILITY_RATE_SCHOOL_perALL=c(857,861),
STUDENT_MOBILITY_RATE_SCHOOL_perMALE=c(881,885),
STUDENT_MOBILITY_RATE_SCHOOL_perFEMALE=c(905,909),
STUDENT_MOBILITY_RATE_SCHOOL_perWHITE=c(929,933),
STUDENT_MOBILITY_RATE_SCHOOL_perBLACK=c(953,957),
STUDENT_MOBILITY_RATE_SCHOOL_perHISPANIC=c(977,981),
STUDENT_MOBILITY_RATE_SCHOOL_perASIAN=c(1001,1005),
STUDENT_MOBILITY_RATE_SCHOOL_perNATIVE_HAWAIIAN_AND_OTHERS=c(1025,1029),
STUDENT_MOBILITY_RATE_SCHOOL_perNATIVE_AMERICAN=c(1049,1053),
STUDENT_MOBILITY_RATE_SCHOOL_perMULTIRACIAL=c(1073,1077),
STUDENT_MOBILITY_RATE_SCHOOL_perLEP=c(1097,1101),
STUDENT_MOBILITY_RATE_SCHOOL_perIEP=c(1121,1125),
STUDENT_MOBILITY_RATE_SCHOOL_perLOW_INCOME=c(1145,1149),
CHRONIC_TRUANTS_num_SCHOOL=c(1169,1173),
CHRONIC_TRUANTS_RATE_SCHOOL_per=c(1196,1200),
DROPOUT_RATE_SCHOOL_perALL=c(1220,1224),
DROPOUT_RATE_SCHOOL_perMALE=c(1244,1248),
DROPOUT_RATE_SCHOOL_perFEMALE=c(1268,1272),
DROPOUT_RATE_SCHOOL_perWHITE=c(1292,1296),
DROPOUT_RATE_SCHOOL_perBLACK=c(1316,1320),
DROPOUT_RATE_SCHOOL_perHISPANIC=c(1340,1344),
DROPOUT_RATE_SCHOOL_perASIAN=c(1364,1368),
DROPOUT_RATE_SCHOOL_perNATIVE_HAWAIIAN_AND_OTHERS=c(1388,1392),
DROPOUT_RATE_SCHOOL_perNATIVE_AMERICAN=c(1412,1416),
DROPOUT_RATE_SCHOOL_perMULTIRACIAL=c(1436,1440),
DROPOUT_RATE_SCHOOL_perLEP=c(1460,1464),
DROPOUT_RATE_SCHOOL_perMIGRANT=c(1484,1488),
DROPOUT_RATE_SCHOOL_perIEP=c(1508,1512),
DROPOUT_RATE_SCHOOL_perLOW_INCOME=c(1532,1536),
HS_4YEAR_GRAD_RATE_SCHOOL_perALL=c(1556,1560),
HS_4YEAR_GRAD_RATE_SCHOOL_perMALE=c(1580,1584),
HS_4YEAR_GRAD_RATE_SCHOOL_perFEMALE=c(1604,1608),
HS_4YEAR_GRAD_RATE_SCHOOL_perWHITE=c(1628,1632),
HS_4YEAR_GRAD_RATE_SCHOOL_perBLACK=c(1652,1656),
HS_4YEAR_GRAD_RATE_SCHOOL_perHISPANIC=c(1676,1680),
HS_4YEAR_GRAD_RATE_SCHOOL_perASIAN=c(1700,1704),
HS_4YEAR_GRAD_RATE_SCHOOL_perNATIVE_HAWAIIAN_AND_OTHERS=c(1724,1728),
HS_4YEAR_GRAD_RATE_SCHOOL_perNATIVE_AMERICAN=c(1748,1752),
HS_4YEAR_GRAD_RATE_SCHOOL_perMULTIRACIAL=c(1772,1776),
HS_4YEAR_GRAD_RATE_SCHOOL_perLEP=c(1796,1800),
HS_4YEAR_GRAD_RATE_SCHOOL_perMIGRANT=c(1820,1824),
HS_4YEAR_GRAD_RATE_SCHOOL_perIEP=c(1844,1848),
HS_4YEAR_GRAD_RATE_SCHOOL_perLOW_INCOME=c(1868,1872),
ACT_COMP_SCHOOL=c(2564,2567),
ACT_ENGL_SCHOOL_SCORE=c(2584,2587),
ACT_MATH_SCHOOL_SCORE=c(2604,2607),
ACT_READ_SCHOOL_SCORE=c(2624,2627),
ACT_SCIE_SCHOOL_SCORE=c(2644,2647),
per_READY_FOR_COLLEGE_COURSE_WORK_SCHOOL=c(2664,2668),
per_STUDENTS_MET_ENGLISH_BENCHMARK_SCHOOL=c(2688,2692),
per_STUDENTS_MET_MATH_BENCHMARK_SCHOOL=c(2712,2716),
per_STUDENTS_MET_READ_BENCHMARK_SCHOOL=c(2736,2740),
per_STUDENTS_MET_SCI_BENCHMARK_SCHOOL=c(2760,2764),
per_STUDENTS_MET_ALL_4_BENCHMARKS_SCHOOL=c(2784,2788),
AVG_CLASS_SIZE_SCHOOL_HS=c(2988,2991),
OVERALL_AVERAGE_CLASS_SIZE_SCHOOL=c(3008,3011),
per_WHITE_TEACHER_DISTRICT=c(3220,3224),
per_HISPANIC_TEACHER_DISTRICT=c(3244,3248),
per_ASIAN_TEACHER_DISTRICT=c(3256,3260),
per_NATIVE_HAWAIIAN_OR_OTHER_PACIFIC_ISLANDER_TEACHER_DISTRICT=c(3268,3272),
per_NATIVE_AMERICAN_TEACHER_DISTRICT=c(3280,3284),
per_TWO_OR_MORE_RACES_TEACHER_DISTRICT=c(3292,3296),
per_UNKNOWN_RACE_TEACHER_DISTRICT=c(3304,3308),
per_MALE_TEACHER_DISTRICT=c(3316,3320),
per_FEMALE_TEACHER_DISTRICT=c(3328,3332),
TOTAL_TEACH_FTE_COUNT_DISTRICT=c(3340,3346),
AVG_TEACH_EXP_DISTRICT=c(3356,3360),
AVG_TEACH_EXP_DISTRICT_HIGH_POVERTY=c(3368,3372),
AVG_TEACH_EXP_DISTRICT_LOW_POVERTY=c(3374,3378),
BACH_DEGREE_DISTRICT=c(3404,3408),
BACH_DEGREE_DISTRICT_HIGH_POVERTY=c(3416,3420),
BACH_DEGREE_DISTRICT_LOW_POVERTY=c(3422,3426),
MAplus_DEGREE_DISTRICT=c(3452,3456),
MAplus_DEGREE_DISTRICT_HIGH_POVERTY=c(3464,3468),
MAplus_DEGREE_DISTRICT_LOW_POVERTY=c(3470,3474),
PUPILTEACHER_RATIO_HS_DISTRICT=c(3524,3528),
PUPILCERTIFIED_STAFF_RATIO_DISTRICT=c(3548,3552),
PUPILADMIN_RATIO_DISTRICT=c(3572,3576),
AVG_TEACHER_SALARY_DISTRICT=c(3596,3603),
AVG_ADMIN_SALARY_DISTRICT=c(3632,3639),
TEACHER_RETENTION_RATE_SCHOOL=c(3668,3672),
num_OF_PRINCIPAL_TURNOVER_WITHIN_6_YEARS_SCHOOL=c(3692,3695),
LOCAL_PROPERTY_TAXES_DISTRICT_DOLLAR201516=c(3712,3726),
LOCAL_PROPERTY_TAXES_DISTRICT_per201516=c(3728,3732),
OTHER_LOCAL_FUNDING_DISTRICT_DOLLAR201516=c(3740,3754),
OTHER_LOCAL_FUNDING_DISTRICT_per201516=c(3756,3760),
GENERAL_STATE_AID_DISTRICT_DOLLAR201516=c(3768,3782),
GENERAL_STATE_AID_DISTRICT_per201516=c(3784,3788),
OTHER_STATE_FUNDING_DISTRICT_DOLLAR201516=c(3796,3810),
OTHER_STATE_FUNDING_DISTRICT_per201516=c(3812,3816),
FEDERAL_FUNDING_DISTRICT_DOLLAR201516=c(3824,3838),
FEDERAL_FUNDING_DISTRICT_per201516=c(3840,3844),
TOTAL_REVENUE_SOURCE201516=c(3852,3866),
EAV_PER_PUPIL_DISTRICT2014=c(3868,3877),
TOT_SCHL_TAX_RATE_PER_100_DISTRICT2014=c(3901,3905),
INSTRUCT_EXPEND_PER_PUPIL_DISTRICT201516=c(3919,3926),
OPER_EXPEND_PP_DISTRICT201516=c(3955,3962),
INSTRUCTION__DOLLARS201516=c(3991,4005),
INSTRUCTION__DISTRICT_per201516=c(4007,4011),
GENERAL_ADMIN__DOLLARS201516=c(4019,4033),
GENERAL_ADMIN__DISTRICT_per201516=c(4035,4039),
SUPPORTING_SERVICES__DOLLARS201516=c(4047,4061),
SUPPORTING_SERVICES__DISTRICT_per201516=c(4063,4067),
OTHER_EXPENDITURES__DOLLARS201516=c(4075,4089),
OTHER_EXPENDITURES__DISTRICT_per201516=c(4091,4095),
EDUCATION_FUND_DOLLARS201516=c(4103,4117),
EDUCATION_FUND_DISTRICT_per201516=c(4119,4123),
OPERATIONS_B_M_DOLLARS201516=c(4131,4145),
OPERATIONS_B_M_DISTRICT_per201516=c(4147,4151),
TRANSPORTATION_DOLLARS201516=c(4159,4173),
TRANSPORTATION_DISTRICT_per201516=c(4175,4179),
DEBT_SERVICE_DOLLARS201516=c(4187,4201),
DEBT_SERVICE_DISTRICT_per201516=c(4203,4207),
TORT_DOLLARS201516=c(4215,4229),
TORT_DISTRICT_per201516=c(4231,4235),
MUNIC_RET_SOC_SECURITY_DOLLARS201516=c(4243,4257),
MUNIC_RET_SOC_SECURITY_DISTRICT_per201516=c(4259,4263),
FIRE_PREV_SAFETY_DOLLARS201516=c(4271,4285),
FIRE_PREV_SAFETY_DISTRICT_per201516=c(4287,4291),
CAPITAL_PROJECTS_FUND_DOLLARS201516=c(4299,4313),
CAPITAL_PROJECTS_FUND_DISTRICT_per201516=c(4315,4319),
TOTAL_EXPENDITURES201516=c(4327,4341),
LEGISLATIVE_SCHOOL=c(4347,4348),
LEGISLATIVE_DISTRICT=c(4350,4351),
per_GRADUATES_ENROLLED_IN_COLLEGE_WITHIN_16_MONTHS_SCHOOL=c(5457,5461),
per_GRADUATES_ENROLLED_IN_COLLEGE_WITHIN_12_MONTHS_SCHOOL=c(5481,5485),
per_FRESHMAN_ON_TRACK_SCHOOL=c(5505,5509),
num_of_CTE_ENROLLMENT_SCHOOL=c(5553,5557),
num_OF_GRADE_10_STUDENTS_TOOK_ADVANCED_COURSES_SCHOOLALL=c(5585,5589),
num_OF_GRADE_11_STUDENTS_TOOK_ADVANCED_COURSES_SCHOOLALL=c(5611,5615),
num_OF_GRADE_12_STUDENTS_TOOK_ADVANCED_COURSES_SCHOOLALL=c(5637,5641),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLALL=c(5663,5667),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLWHITE=c(5689,5693),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLBLACK=c(5715,5719),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLHISPANIC=c(5741,5745),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLASIAN=c(5767,5771),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNATIVE_HAWAIIAN_AND_OTHERS=c(5793,5797),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNATIVE_AMERICAN=c(5819,5823),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLTWO_OR_MORE_RACES=c(5845,5849),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLLEP=c(5871,5875),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNONLEP=c(5897,5901),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLIEP=c(5923,5927),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNONIEP=c(5949,5953),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLLOW_INCOME=c(5975,5979),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNONLOW_INCOME=c(6001,6005),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLALL=c(6027,6031),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLWHITE=c(6053,6057),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLBLACK=c(6079,6083),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLHISPANIC=c(6105,6109),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLASIAN=c(6131,6135),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNATIVE_HAWAIIAN_AND_OTHERS=c(6157,6161),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNATIVE_AMERICAN=c(6183,6187),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLTWO_OR_MORE_RACES=c(6209,6213),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLLEP=c(6235,6239),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNONLEP=c(6261,6265),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLIEP=c(6287,6291),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNONIEP=c(6313,6317),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLLOW_INCOME=c(6339,6343),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNONLOW_INCOME=c(6365,6369),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLALL=c(6391,6395),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLWHITE=c(6417,6421),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLBLACK=c(6443,6447),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLHISPANIC=c(6469,6473),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLASIAN=c(6495,6499),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNATIVE_HAWAIIAN_AND_OTHERS=c(6521,6525),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNATIVE_AMERICAN=c(6547,6551),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLTWO_OR_MORE_RACES=c(6573,6577),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLLEP=c(6599,6603),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNONLEP=c(6625,6629),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLIEP=c(6651,6655),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNONIEP=c(6677,6681),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLLOW_INCOME=c(6703,6707),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_COURSES_SCHOOLNONLOW_INCOME=c(6729,6733),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLALL=c(6755,6759),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLWHITE=c(6781,6785),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLBLACK=c(6807,6811),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLHISPANIC=c(6833,6837),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLASIAN=c(6859,6863),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNATIVE_HAWAIIAN_AND_OTHERS=c(6885,6889),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNATIVE_AMERICAN=c(6911,6915),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLTWO_OR_MORE_RACES=c(6937,6941),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLLEP=c(6963,6967),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNONLEP=c(6989,6993),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLIEP=c(7015,7019),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNONIEP=c(7041,7045),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLLOW_INCOME=c(7067,7071),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNONLOW_INCOME=c(7093,7097),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLALL=c(7119,7123),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLWHITE=c(7145,7149),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLBLACK=c(7171,7175),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLHISPANIC=c(7197,7201),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLASIAN=c(7223,7227),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNATIVE_HAWAIIAN_AND_OTHERS=c(7249,7253),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNATIVE_AMERICAN=c(7275,7279),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLTWO_OR_MORE_RACES=c(7301,7305),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLLEP=c(7327,7331),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNONLEP=c(7353,7357),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLIEP=c(7379,7383),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNONIEP=c(7405,7409),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLLOW_INCOME=c(7431,7435),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNONLOW_INCOME=c(7457,7461),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLALL=c(7483,7487),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLWHITE=c(7509,7513),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLBLACK=c(7535,7539),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLHISPANIC=c(7561,7565),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLASIAN=c(7587,7591),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNATIVE_HAWAIIAN_AND_OTHERS=c(7613,7617),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNATIVE_AMERICAN=c(7639,7643),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLTWO_OR_MORE_RACES=c(7665,7669),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLLEP=c(7691,7695),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNONLEP=c(7717,7721),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLIEP=c(7743,7747),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNONIEP=c(7769,7773),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLLOW_INCOME=c(7795,7799),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_IB_COURSES_SCHOOLNONLOW_INCOME=c(7821,7825),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLALL=c(7847,7851),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLWHITE=c(7873,7877),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLBLACK=c(7899,7903),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLHISPANIC=c(7925,7929),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLASIAN=c(7951,7955),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNATIVE_HAWAIIAN_AND_OTHERS=c(7977,7981),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNATIVE_AMERICAN=c(8003,8007),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLTWO_OR_MORE_RACES=c(8029,8033),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLLEP=c(8055,8059),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNONLEP=c(8081,8085),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLIEP=c(8107,8111),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNONIEP=c(8133,8137),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLLOW_INCOME=c(8159,8163),
num_OF_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNONLOW_INCOME=c(8185,8189),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLALL=c(8211,8215),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLWHITE=c(8237,8241),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLBLACK=c(8263,8267),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLHISPANIC=c(8289,8293),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLASIAN=c(8315,8319),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNATIVE_HAWAIIAN_AND_OTHERS=c(8341,8345),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNATIVE_AMERICAN=c(8367,8371),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLTWO_OR_MORE_RACES=c(8393,8397),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLLEP=c(8419,8423),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNONLEP=c(8445,8449),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLIEP=c(8471,8475),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNONIEP=c(8497,8501),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLLOW_INCOME=c(8523,8527),
num_OF_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNONLOW_INCOME=c(8549,8553),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLALL=c(8575,8579),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLWHITE=c(8601,8605),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLBLACK=c(8627,8631),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLHISPANIC=c(8653,8657),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLASIAN=c(8679,8683),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNATIVE_HAWAIIAN_AND_OTHERS=c(8705,8709),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNATIVE_AMERICAN=c(8731,8735),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLTWO_OR_MORE_RACES=c(8757,8761),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLLEP=c(8783,8787),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNONLEP=c(8809,8813),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLIEP=c(8835,8839),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNONIEP=c(8861,8865),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLLOW_INCOME=c(8887,8891),
num_OF_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_DUAL_CREDIT_COURSES_SCHOOLNONLOW_INCOME=c(8913,8917),
num_of_AP_EXAMS_TAKEN_BY_GRADE_10_STUDENTS_SCHOOL=c(8939,8943),
num_of_AP_EXAMS_PASSED_BY_GRADE_10_STUDENTS_SCHOOL=c(8961,8965),
num_of_GRADE_10_STUDENTS_TOOK_ONE_OR_MORE_AP_EXAMS_SCHOOL=c(8983,8987),
num_of_GRADE_10_STUDENTS_PASSED_ONE_OR_MORE_AP_EXAMS_SCHOOL=c(9005,9009),
num_of_AP_EXAMS_TAKEN_BY_GRADE_11_STUDENTS_SCHOOL=c(9027,9031),
num_of_AP_EXAMS_PASSED_BY_GRADE_11_STUDENTS_SCHOOL=c(9049,9053),
num_of_GRADE_11_STUDENTS_TOOK_ONE_OR_MORE_AP_EXAMS_SCHOOL=c(9071,9075),
num_of_GRADE_11_STUDENTS_PASSED_ONE_OR_MORE_AP_EXAMS_SCHOOL=c(9093,9097),
num_of_AP_EXAMS_TAKEN_BY_GRADE_12_STUDENTS_SCHOOL=c(9115,9119),
num_of_AP_EXAMS_PASSED_BY_GRADE_12_STUDENTS_SCHOOL=c(9137,9141),
num_of_GRADE_12_STUDENTS_TOOK_ONE_OR_MORE_AP_EXAMS_SCHOOL=c(9159,9163),
num_of_GRADE_12_STUDENTS_PASSED_ONE_OR_MORE_AP_EXAMS_SCHOOL=c(9181,9185),
per_OF_GRADUATES_ENROLLED_IN_COMMUNITY_COLLEGE_REMEDIAL_COURSES_SCHOOLALL=c(9203,9207),
STUDENT_RESPONSE_RATE_SCHOOL_DATA=c(9227,9231),
TEACHER_RESPONSE_RATE_SCHOOL_DATA=c(9233,9237),
AVERGE_NUMBER_OF_DAYS_OF_PHYSICAL_EDUCATION_PER_WEEK_PER_STUDENT_SCHOOL=c(9263,9263),
TEACHER_ATTENDANCE_RATE_SCHOOLALL=c(9273,9277),
per_of_TEACHERS_RATED_AS_PROFICIENT_OR_EXCELLENT_DISTRICT=c(9297,9301),
num_OF_SCHOOLS_IN_THE_DISTRICT_AND_OTHER_ADMINISTRATIVE_ENTITIES_FOR_REPORT_CARD=c(9309,9311)),
progress = TRUE)

#remove special symbols like , and $ from some variables
rc17$CHRONIC_TRUANTS_num_SCHOOL <- as.numeric(gsub('[$,]', '', rc17$CHRONIC_TRUANTS_num_SCHOOL))
rc17$num_of_AP_EXAMS_TAKEN_BY_GRADE_10_STUDENTS_SCHOOL <- as.numeric(gsub('[$,]', '', rc17$num_of_AP_EXAMS_TAKEN_BY_GRADE_10_STUDENTS_SCHOOL))
rc17$num_of_AP_EXAMS_PASSED_BY_GRADE_11_STUDENTS_SCHOOL <- as.numeric(gsub('[$,]', '', rc17$num_of_AP_EXAMS_PASSED_BY_GRADE_11_STUDENTS_SCHOOL))
rc17$AVG_TEACHER_SALARY_DISTRICT <- as.numeric(gsub('[$,]', '',rc17$AVG_TEACHER_SALARY_DISTRICT))
rc17$AVG_ADMIN_SALARY_DISTRICT <- as.numeric(gsub('[$,]', '',rc17$AVG_ADMIN_SALARY_DISTRICT))
rc17$TOTAL_REVENUE_SOURCE201516 <- as.numeric(gsub('[$,]', '',rc17$TOTAL_REVENUE_SOURCE201516))
rc17$TOTAL_EXPENDITURES201516 <- as.numeric(gsub('[$,]', '',rc17$TOTAL_EXPENDITURES201516))
rc17$INSTRUCT_EXPEND_PER_PUPIL_DISTRICT201516 <- as.numeric(gsub('[$,]', '',rc17$INSTRUCT_EXPEND_PER_PUPIL_DISTRICT201516))
rc17$EAV_PER_PUPIL_DISTRICT2014 <- as.numeric(gsub('[$,]', '',rc17$EAV_PER_PUPIL_DISTRICT2014))

#subset counties in Chicago area
sixco <- rc17 %>% 
  filter(COUNTY %in% c("Cook", "Lake", "Will", "Kane", "McHenry", "Dupage"))

#subset six-county high schools
sixco_hs <- sixco %>% 
  filter(SCHOOL_TYPE_NAME == "HIGH SCHOOL")
```

---

# Variables
rc17.txt - 3,796 Illinois Schools (rows)

![](EDA_present_files/figure-html/rc17_fwf.png)

---
# Variables
RC17_layout.xlsx - 1,471 variables (columns)

![](EDA_present_files/figure-html/rc17_lay.png)

--
## 5,583,916 cells in a spreadsheet!
---
# Variables

.pull-left[
School information (13 variables;12 imported)

Student demographics (396;71)

ACT (44;11)

Instructional setting (92;2)

Teacher and admin statistics (78;26)

District financial (67;40)

Region and legislative (3;2)

National Assmnt. of Educ. Progress (NAEP) (184;0)

College and Career readiness (16;3)

CTE (4;1)

Advanced coursework (12;3)]

.pull-right[
AP courses (168;42)

IB courses (168;42)

Dual credit (168;42)

AP exams (36;12)

Post secondary remediation (4;1)

Response rate (5E survey) (4;2)

Health and wellness (3;1)

Teacher Attendance (4;1)

Teacher Evaluation (2;1)

School District Count (3;1)]

---

# State Demographics
```{r school_type_table}
school_type <- rc17 %>% 
  count(SCHOOL_TYPE_NAME, sort = TRUE) %>% 
  mutate(rel_freq = n/sum(n))
school_type
```
---
## State Demographics
```{r school_type_table_formatted}
kable(school_type) %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE)
```
---
Write a short analysis for the types of schools in the state of Illinois.
```{r school_type_bar, fig.height = 6 , fig.width = 10}
ggplot(rc17, aes(x=factor(SCHOOL_TYPE_NAME)))+
  geom_bar(fill="steelblue")+
  labs(title = "Type of School", x = "School Type", subtitle = "All Illinois Schools") +
  theme_minimal()
```

---
class: center, middle
# Overview
```{r echo = FALSE}
mycol <- rgb(.184,.306,.435, alpha = .005)
par(bg = mycol)
slices <- c(3.3,3.3,3.3,.1)
lbls <- c("School Data", "Pedagogy", "Software", "Humor")
pie(slices, labels = lbls, main="Using the Illinois Report Card \n Data to Teach Statistics", cex = 1.5, cex.main = 1.5)
```
---
background-image: url(https://imgs.xkcd.com/comics/normal_distribution.png)

---
Adding a third variable:
```{r echo = TRUE, fig.show = 'hide'}
rc17 %>% 
filter(COUNTY == "Dupage" | COUNTY == "Will" | COUNTY == "Kane" | #<<
         COUNTY == "Lake" | COUNTY == "Cook"| COUNTY == "McHenry") %>% #<<
# there's a better way...  
ggplot(aes(x=factor(SCHOOL_TYPE_NAME), y = (..count..)/sum(..count..))) + #<<
  geom_bar(fill="#2F4E6F")+
  facet_wrap(~COUNTY, nrow = 2) + #<<
  labs(title = "Type of School by County", 
       x = "School Type", 
       y = "proportion",
       subtitle = "Six Counties in the Chicago Metropolitan Region") +
  theme_minimal()  +
  theme(axis.text.x = element_text(angle = 60, vjust = 0.5))
```

.image-15[![](EDA_present_files/figure-html/six_county.gif)]


---
Write a short analysis for the types of schools in the six county region.

```{r school_type_by_county, echo = FALSE, fig.height = 8, fig.width = 12}
rc17 %>% 
filter(COUNTY == "Dupage" | COUNTY == "Will" | COUNTY == "Kane" | 
         COUNTY == "Lake" | COUNTY == "Cook"| COUNTY == "McHenry") %>% 
ggplot(aes(x=factor(SCHOOL_TYPE_NAME), y = (..count..)/sum(..count..))) +
  geom_bar(fill="#2F4E6F")+
  facet_wrap(~COUNTY, nrow = 2) +
  labs(title = "Type of School by County", 
       x = "School Type", 
       y = "proportion",
       subtitle = "Six Counties in the Chicago Metropolitan Region") +
  theme_minimal()  +
  theme(axis.text.x = element_text(angle = 60, vjust = 0.5))
```
---
# Software
.pull-left[

* R and RStudio


![](EDA_present_files/figure-html/r.png)


![](EDA_present_files/figure-html/RStudio.png)

]
.pull-right[

* Fathom

![](EDA_present_files/figure-html/fathom.png)


* Others
  - Excel
  - MiniTab
  - JMP
  - SAS

]

---
# Data

.pull-left[
## Super Easy
* All output (graphs and tables) are available at

https://github.com/fbriody/MMC2020

then look in the EDA_present_files folder.

* Minor modifications can be (quickly?) made available
]

.pull-right[
## Easy
The six county .csv file is available at http://frankbriody.com/rc17_data.zip.
* Contains 316 variables for 2,049 schools
* 2.7 MB
* No need to run the import script.
* In R: ```newdata <- read.csv(file = 'datafile.csv')``` imports and creates a data table named ```newdata```. I named my data table ```sixco```.
]
---

# Data

.pull-left[
## Some Variables for All Schools
The subset of 316 variables for all 3,796 Illinois schools is also available for download at http://frankbriody.com/rc17_data.zip. 
* 5 MB
* No need to run the import script.
* In R: ```newdata <- read.csv(file = 'datafile.csv')``` imports and creates a data table named ```newdata```. I named my data table ```rc17```.
]
.pull-right[
## Starting from Scratch
* Start with raw ISBE file **rc17.txt**.
* Read the variable names in **RC17_layout.xlsx**. 
* Use or modify the import script ```import_rc17.txt``` available at https://github.com/fbriody/MMC2020, or make your own script.
]

---
background-image: url(EDA_present_files/figure-html/cyoa.jpg)

---
# Numeric Summaries
To get the number of High Schools per county in the Six County Region:

```{r}
sixco %>% 
  filter(SCHOOL_TYPE_NAME == "HIGH SCHOOL") %>% 
  group_by(COUNTY) %>% #<<
  summarise(count = n())
```

---

# Numeric Summaries

McHenry county seems like a good candidate for small-set data that can be analyzed with a graphing calculator. Subsetting based on a criteria produces a single list of scores. 

```{r}
mchenry_act <- rc17 %>% 
  filter(COUNTY == "McHenry", is.na(ACT_COMP_SCHOOL) == FALSE ) #don't include missing
# dataframe$variable
mchenry_act$ACT_COMP_SCHOOL #<<
```

---
# Numeric Summaries

Adding **sort()** orders the scores. Remove the comma and the **decreasing** option to produce an increasing list. 


```{r}
sort(mchenry_act$ACT_COMP_SCHOOL, decreasing = TRUE)
```

---
# Numeric Summaries

Lake County is a little larger, but a boxplot can be quickly made from an ordered and formatted table of ACT Scores. Create a boxplot for Lake County ACT scores. How could you compare to DuPage county?

```{r echo = TRUE, results =  'hide'}
lake_ACT <- rc17 %>% 
  filter(SCHOOL_TYPE_NAME == "HIGH SCHOOL", COUNTY == "Lake") %>% 
  arrange(desc(ACT_COMP_SCHOOL)) %>% 
  select(COUNTY, SCHOOL_NAME, ACT = ACT_COMP_SCHOOL)
kable(lake_ACT)
```

---

```{r lake_act_table, echo = FALSE}
lake_ACT <- rc17 %>% 
  filter(SCHOOL_TYPE_NAME == "HIGH SCHOOL", COUNTY == "Lake") %>% 
  arrange(desc(ACT_COMP_SCHOOL)) %>% 
  select(COUNTY, SCHOOL_NAME, ACT = ACT_COMP_SCHOOL)
dt_lake_ACT <- as.data.frame(lake_ACT) #kable version doesn't fit on slide
dt_lake_ACT[1:21,]
```

---

# Two Way Tables

```{r}
district_type <- rc17 %>% 
  filter(COUNTY == "Lake" | COUNTY == "Dupage") %>% 
  group_by(COUNTY)

two_way <- with(district_type, table(DISTRICT_SIZE_NAME, COUNTY))

kable(two_way, caption = "Types of School Districts") %>%
  kable_styling(bootstrap_options = "striped", full_width = F, latex_options = "hold_position")
```

---

# Mean vs Median

A numeric summary for instructional spending per pupil by district:
```{r}
rc17 %>% 
  filter(SCHOOL_TYPE_NAME == "HIGH SCHOOL") %>% 
  group_by(DISTRICT_NAME) %>% 
  summarize(spend_stu = mean(INSTRUCT_EXPEND_PER_PUPIL_DISTRICT201516, na.rm = TRUE)) %>% 
  summary()
```

---

Putting summary numbers on a plot (code available on GitHub):

```{r echo = FALSE,  warning = FALSE, fig.height = 7.5, fig.width = 12}
spend_stu_plot <- rc17 %>% 
  filter(SCHOOL_TYPE_NAME == "HIGH SCHOOL") %>% 
  group_by(DISTRICT_NAME) %>% 
  summarise(spend_stu = mean(INSTRUCT_EXPEND_PER_PUPIL_DISTRICT201516, na.rm = TRUE)) %>% 
  ggplot(mapping = aes(x = spend_stu)) +
  geom_histogram(binwidth = 500, color = "Blue", fill = "LightBlue") +
  scale_x_continuous(labels = dollar)

spend_stu_plot +
geom_segment(aes(x=5912, y=62.5, xend=5912, yend=0), 
             arrow = arrow(length = unit(.03, "npc")), 
             color="DarkGreen") +
  geom_segment(aes(x=6571, y=75, xend=6571, yend=0), 
              arrow = arrow(length = unit(.03, "npc")), 
              color="DarkRed") + 
  geom_label(aes(x=5912, y=62.5,  
              label = "Median \n $5,912"), 
              nudge_x = -400) + 
  geom_label(aes(x=6571, y=75,  
              label = "Mean \n $6,571"), 
              nudge_x = 400) + 
  geom_segment(aes(x=12405, y=80, xend=12405, yend=0), 
              arrow = arrow(length = unit(.03, "npc")), 
              color="DarkBlue") + 
  geom_label(aes(x=12405, y=80,  
              label = "PHS \n $12,405"), 
              nudge_x = 400) + 
  theme_minimal()

```

---

background-image: url(https://imgs.xkcd.com/comics/convincing.png)

---

# Boxplots

```{r echo = TRUE, fig.show = 'hide'}
sixco  %>% 
  filter(SCHOOL_TYPE_NAME == "HIGH SCHOOL") %>% 
  ggplot(mapping = aes(x = COUNTY, y = ACT_COMP_SCHOOL)) +
  geom_boxplot(color = "Blue") + 
  theme_minimal() + 
  coord_flip() + #horizontal boxplots preferred #<<
  labs(x = "County", y = "Composite ACT", 
       title = "High School Composite ACT Scores")
```

---

Comment on the distribution of ACT scores both within and between counties. For which counties would you expect the mean to be close to the median? Which county or counties would prefer to report the median instead of the mean?

```{r act_boxplot, echo = FALSE, warning = FALSE,  fig.height = 7.5, fig.width = 12}
sixco  %>% 
  filter(SCHOOL_TYPE_NAME == "HIGH SCHOOL") %>% 
  ggplot(mapping = aes(x = COUNTY, y = ACT_COMP_SCHOOL)) +
  geom_boxplot(color = "Blue") + 
  theme_minimal() + 
  coord_flip() +
  labs(x = "County", y = "Composite ACT", 
       title = "Composite ACT Scores for High Schools")
```

---

# Finding a School

```{r}
rc17 %>% 
  filter(str_detect(SCHOOL_NAME, "Morton")) %>% 
  select(SCHOOL_ID, SCHOOL_NAME, ACT_COMP_SCHOOL)
```

---

# Using a Filter

```{r}
prospect <- rc17 %>% 
  filter(str_detect(SCHOOL_NAME, "Prospect High School"))
prospect_act <- prospect$ACT_COMP_SCHOOL
prospect_act
```

---

# Using a Function


If you put this right after the data import step you can always find single values for a specific school quickly.  
```{r}
phs_value <- function(unk) {
  x <- rc17 %>% 
    filter(SCHOOL_ID == "050162140170005")
  x[unk]
}

phs_value("ACT_COMP_SCHOOL")
```


---

### Guess the Correlation Coefficient
.pull-left7030[
```{r act_tru_num, echo=FALSE, message=FALSE, warning=FALSE, fig.height = 8, fig.width = 12}
truants <- sixco %>% ggplot(mapping = aes(x = CHRONIC_TRUANTS_num_SCHOOL, y = ACT_COMP_SCHOOL)) +
  geom_point(color="Blue") +
  labs(x = "Chronically Truant (number)", 
       y = "School ACT Composite", 
       title = "Truancy and ACT Score", 
       subtitle = "Six County High Schools")

truants
```
]

---
### Guess the Correlation Coefficient
.pull-left7030[
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.height = 8, fig.width = 12}
truants <- truants +
  geom_point(color=ifelse(sixco$SCHOOL_NAME == "Prospect High School", "Red", "Blue"))

truants
```

]
--
.pull-right7030[
Correlation Coefficient
```{r echo=FALSE, message=FALSE, warning=FALSE}
cor(sixco$CHRONIC_TRUANTS_num_SCHOOL, sixco$ACT_COMP_SCHOOL, use = "pairwise.complete.obs")
```

Truants for PHS
.output[
```{r echo=FALSE}
phs_value("CHRONIC_TRUANTS_num_SCHOOL")

```
]
]
---
### Guess the Correlation Coefficient
.pull-left7030[
```{r act_tru_per, echo=FALSE, message=FALSE, warning=FALSE, fig.height = 8, fig.width = 12}
truant_n <- sixco %>% ggplot(mapping = aes(x = CHRONIC_TRUANTS_RATE_SCHOOL_per, y = ACT_COMP_SCHOOL)) +
  geom_point(color="Blue") +
  labs(x = "Chronically Truant (Percent)", 
       y = "School ACT Composite", 
       title = "Truancy and ACT Score", 
       subtitle = "Six County High Schools")
truant_n
```
]
---
### Guess the Correlation Coefficient
.pull-left7030[
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.height = 8, fig.width = 12}
truant_n <- truant_n +
  geom_point(color=ifelse(sixco$SCHOOL_NAME == "Prospect High School", "Red", "Blue"))

truant_n
```
]
--
.pull-right7030[
Correlation Coefficient
```{r echo=FALSE, message=FALSE, warning=FALSE}
cor(sixco$CHRONIC_TRUANTS_RATE_SCHOOL_per,sixco$ACT_COMP_SCHOOL, use = "pairwise.complete.obs")
```

Truants for PHS
.output[
```{r echo=FALSE}
chr_tru <- phs_value("CHRONIC_TRUANTS_RATE_SCHOOL_per")
select(chr_tru,"PHS Truant Rate"=CHRONIC_TRUANTS_RATE_SCHOOL_per)
```
]
]
---
### Guess the Correlation Coefficient
.pull-left7030[
```{r act_mobil, echo=FALSE, message=FALSE, warning=FALSE, fig.height = 8, fig.width = 12}
mobility <- sixco %>% ggplot(mapping = aes(x = STUDENT_MOBILITY_RATE_SCHOOL_perALL, y = ACT_COMP_SCHOOL)) +
  geom_point(color="Blue") +
  labs(x = "Student Mobility Rate (Percent)", 
       y = "School ACT Composite", 
       title = "Mobility and ACT Score", 
       subtitle = "Six County High Schools")

mobility
```
]

---

### Guess the Correlation Coefficient

.pull-left7030[
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.height = 8, fig.width = 12}
mobility <- mobility + 
  geom_point(color=ifelse(sixco$SCHOOL_NAME == "Prospect High School", "Red", "Blue"))

mobility
```
]
--
.pull-right7030[
Correlation Coefficient
```{r echo=FALSE, message=FALSE, warning=FALSE, fig.height = 8, fig.width = 12}
cor(sixco$STUDENT_MOBILITY_RATE_SCHOOL_perALL,sixco$ACT_COMP_SCHOOL, use = "pairwise.complete.obs")
```

Mobility for PHS
.output[
```{r echo=FALSE}
phs_mob <- phs_value("STUDENT_MOBILITY_RATE_SCHOOL_perALL")
select(phs_mob, "PHS Mobility" = STUDENT_MOBILITY_RATE_SCHOOL_perALL)
```
]
]
---

### Guess the Correlation Coefficient
.pull-left7030[
```{r act_attend, echo=FALSE, warning=FALSE, message=FALSE, fig.height = 8, fig.width = 12}
attend <- sixco %>% ggplot(mapping = aes(x= ATTENDANCE_RATE_SCHOOL_perALL, y = ACT_COMP_SCHOOL)) +
  geom_point(color="Blue") +
  labs(x = "Attendance Rate (Percent)", 
       y = "School ACT Composite", 
       title = "Attendance and ACT Score", 
       subtitle = "Six County High Schools")

attend
```
]

---
### Guess the Correlation Coefficient
.pull-left7030[
```{r echo=FALSE, warning=FALSE, message=FALSE, fig.height = 8, fig.width = 12}
attend <- attend + 
  geom_point(color=ifelse(sixco$SCHOOL_NAME == "Prospect High School", "Red", "Blue"))

attend
```
]
--
.pull-right7030[
Correlation Coefficient
```{r echo=FALSE, warning=FALSE, message=FALSE}
cor(sixco$ATTENDANCE_RATE_SCHOOL_perALL,sixco$ACT_COMP_SCHOOL, use = "pairwise.complete.obs")
```
Attendance for PHS
.output[
```{r echo=FALSE}
phs_aten <- phs_value("ATTENDANCE_RATE_SCHOOL_perALL")
select(phs_aten, "PHS Attend Rate" = ATTENDANCE_RATE_SCHOOL_perALL)
```
]
]
---
**Scatterplot Analysis** ~ The analysis of scatterplots should lead to a discussion about outliers, influentials and regression details. 

```{r act_low_inc, echo = FALSE, warning = FALSE,  fig.height = 7.5, fig.width = 12}
ACTvLI <- sixco %>% 
  ggplot(mapping = aes(x = LOWINCOME_SCHOOL_per, y = ACT_COMP_SCHOOL)) +
  geom_point(color="Blue", size = 1) +
  labs(title = "Low Income Students and ACT Score", x = "School Low Income (%)", y = "School ACT Composite" ) +
  theme_minimal() 
ACTvLI
```
---
**Scatterplot Analysis**  ~ The analysis of scatterplots should lead to a discussion about outliers, influentials and regression details. 

```{r fig.show= 'hide', warning = FALSE, fig.height = 7.5, fig.width = 12}
ACTvLI + 
  geom_text(aes(label=ifelse(SCHOOL_ID =="050162140170005",
                             as.character(SCHOOL_NAME),'')),hjust=0,vjust=0) +
  geom_text_repel(aes(LOWINCOME_SCHOOL_per, ACT_COMP_SCHOOL, 
                      label = ifelse(ACT_COMP_SCHOOL >25 & #<<
                                     LOWINCOME_SCHOOL_per>25, #<< 
                                     SCHOOL_NAME, "")), size = 3)
```
---

**Scatterplot Analysis**  ~ The analysis of scatterplots should lead to a discussion about outliers, influentials and regression details. 

```{r echo = FALSE, warning = FALSE, fig.height = 7.5, fig.width = 12}
ACTvLI + 
  geom_text(aes(label=ifelse(SCHOOL_ID =="050162140170005",
                             as.character(SCHOOL_NAME),'')),hjust=0,vjust=0) +
  geom_text_repel(aes(LOWINCOME_SCHOOL_per, ACT_COMP_SCHOOL, 
                      label = ifelse(ACT_COMP_SCHOOL >25 & 
                                     LOWINCOME_SCHOOL_per>25, 
                                     SCHOOL_NAME, "")), size = 3)
```
---
**Predicting ACT Scores from Attendance** ~ Analysis questions?

```{r echo = FALSE, message=FALSE, warning=FALSE, fig.height = 7.5, fig.width = 12}
sixco %>% ggplot(mapping = aes(x= ATTENDANCE_RATE_SCHOOL_perALL, y = ACT_COMP_SCHOOL)) +
  geom_point(aes(alpha = sixco$SCHOOL_TOTAL_ENROLLMENT), color = "DarkBlue") + #alpha is transparency
  labs(alpha = "Enrollment", x = "Attendance Rate", 
       y = "ACT Composite", title = "Predicting ACT from Attendance", 
       subtitle = "Six County High Schools") +
  theme_minimal() +
  theme(legend.position = c(.165, .75), text = element_text(size=10))
```

---

```{r}
summary(lm(sixco$ACT_COMP_SCHOOL~sixco$ATTENDANCE_RATE_SCHOOL_perALL))
```

---

```{r}
sixco_removed <- sixco %>% 
  filter(ATTENDANCE_RATE_SCHOOL_perALL>50) 
summary(lm(sixco_removed$ACT_COMP_SCHOOL~sixco_removed$ATTENDANCE_RATE_SCHOOL_perALL))
```

---
**Both Models Graphed**

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.height = 8, fig.width = 12}
sixco %>% 
  filter(ATTENDANCE_RATE_SCHOOL_perALL>50) %>% 
  ggplot(mapping = aes(x= ATTENDANCE_RATE_SCHOOL_perALL, y = ACT_COMP_SCHOOL, alpha = SCHOOL_TOTAL_ENROLLMENT)) +
  geom_point(color = "DarkBlue") + 
  geom_smooth(method = lm, na.rm = TRUE, se = FALSE) + 
  geom_abline(intercept = -11.07428, slope = 0.34033, color = "Red") + 
  theme_minimal() +
  theme(legend.position = "none",text = element_text(size=10))
```

---

background-image: url(https://imgs.xkcd.com/comics/extrapolating.png)

---

**Residual Plot**

```{r act_atten_resid, echo=FALSE, message=FALSE, warning=FALSE, fig.height = 8, fig.width = 12}
ggplot(lm(sixco$ACT_COMP_SCHOOL~sixco$ATTENDANCE_RATE_SCHOOL_perALL)) + 
  geom_point(mapping = aes(x = .fitted, y = .resid), size = 1) + 
  geom_hline(yintercept = 0, color = "DarkBlue") +
  labs(x = "Predicted ACT Composite", 
       y = "Residual", 
       title = "Predicting ACT from Attendance Rate (%)",
       subtitle = "Residual Plot; By School, Six County Region High Schools") + 
  theme(text = element_text(size = 10))

```

---

# Regression in Fathom

---

# Random Selection and Simulation

## Rolling a die

```{r}
set.seed(2020)
one_die <- sample(1:6, 10, replace = TRUE)
one_die
```

---

## Random Selection

The sample command can be used to generate a random selection. Adding a statistic command (like mean(variable) ) and repeating quickly generates a sampling distribution. 
```{r}
four_schools <-  sample_n(rc17, 4) 
four_schools[c("SCHOOL_NAME", "SCHOOL_TOTAL_ENROLLMENT")]
#alternate form of dataframe$variable is dataframe[variable]
mean(four_schools$SCHOOL_TOTAL_ENROLLMENT)
```

---

## Stratified Sample
```{r}
strat_samp <- sixco %>% 
  filter(SCHOOL_TYPE_NAME == "HIGH SCHOOL") %>% 
  group_by(COUNTY) %>% #stratify by county
  sample_n(3)
strat_samp[c("SCHOOL_NAME", "COUNTY", "SCHOOL_TOTAL_ENROLLMENT")]
```

---

A function to produce random samples and confidence interval bounds.
```{r}
rand_samp <- function(samples, vari, samp_size) {
  sixco_hs_nona <- sixco_hs[!is.na(sixco_hs[vari]), ] #remove schools with no value
  a <- matrix(ncol = 7, nrow = samples)
  for (k in 1:samples){
    dat_fra <- sample_n(sixco_hs_nona, samp_size)
    t_star <- qt(.975, df = samp_size - 1)
    x_bar <- mean(dat_fra[[vari]])
    stan_dev <- sd(dat_fra[[vari]])
    lower_b <- x_bar  - t_star*stan_dev/(samp_size)**.5
    upper_b <- x_bar + t_star*stan_dev/(samp_size)**.5
  v1 <- k
  v2 <- samp_size
  v3 <- x_bar
  v4 <- stan_dev
  v5 <- lower_b
  v6 <- upper_b
  v7 <- mean(sixco_hs[[vari]], na.rm = TRUE)

  a[k,] <- c(v1, v2, v3, v4, v5, v6, v7)} #row k and all columns of matrix a
  colnames(a) <- c("Sample", "Sample_Size", "Mean", "StdDev", "L_Bound", "U_Bound", "Parameter")
  return(a)
  }
```
---

Produce and converting the matrix to a table of output.

```{r}
set.seed(2020)
confid_ints <- as_tibble(rand_samp(29, "ACT_COMP_SCHOOL", 25))
confid_ints
```

---
Plotting confidence intervals and comparing to parameter:
```{r fig.show = 'hide', fig.width=8, fig.height=12}
ggplot(confid_ints, mapping = aes(x=L_Bound, xend = U_Bound, y = Sample)) + 
  geom_point(aes(x=Mean, y=Sample)) + 
    geom_vline(xintercept = mean(confid_ints$Parameter), 
               linetype="dashed", 
                color = "grey", 
               size=1) +
    geom_dumbbell(size_xend=0,size_x=0,
                color = ifelse(confid_ints$U_Bound < confid_ints$Parameter |
                                confid_ints$L_Bound > confid_ints$Parameter,
                                "red", "black")) + 
    labs(x = "Average ACT Score", 
         title = paste(max(confid_ints$Sample), 
                       "Samples of size n =",
                       max(confid_ints$Sample_Size)
                      ),
         subtitle = paste("Parameter = ",round(confid_ints$Parameter,2))
         ) + 
  theme_minimal()
```

---

Plotting confidence intervals and comparing to parameter:
```{r confid_ints, echo = FALSE, fig.width=12, fig.height=8}
ggplot(confid_ints, mapping = aes(x=L_Bound, xend = U_Bound, y = Sample)) + 
  geom_point(aes(x=Mean, y=Sample)) + 
    geom_vline(xintercept = mean(confid_ints$Parameter), 
               linetype="dashed", 
                color = "grey", 
               size=1) +
    geom_dumbbell(size_xend=0,size_x=0,
                color = ifelse(confid_ints$U_Bound < confid_ints$Parameter |
                                confid_ints$L_Bound > confid_ints$Parameter,
                                "red", "black")) + 
    labs(x = "Average ACT Score", 
         title = paste(max(confid_ints$Sample), 
                       "Samples of size n =",
                       max(confid_ints$Sample_Size)
                      ),
         subtitle = paste("Parameter = ",round(confid_ints$Parameter,2))
         ) + 
  theme_minimal()
```

---
# Learning More

.pull-left7030[
* R and RStudio
    + R for Data Science by Garrett Grolemund and Hadley Wickham
* Fathom
    + https://fathom.concord.org/help/HelpFiles/index.html
* GitHub (https://github.com/fbriody)
    + Start with README.md (bottom of https://github.com/fbriody/MMC2020 ).
    + Code for handout is ```handout.Rmd```.
    + Code for presentation is ```EDA_present.Rmd```.
* Statistics
    + DePaul
    + Udacity
    + CodeAcademy
    + DataCamp
]    

.pull-right7030[
![](EDA_present_files/figure-html/r4ds.png)

]



  
---
# THANK YOU for attending

* Comics from Randall Munroe at https://xkcd.com/ 
* Keep in touch - what we do is important

![](https://imgs.xkcd.com/comics/correlation.png)

*Contact Info*

* email: frankbriody@gmail.com
* GitHub: https://github.com/fbriody
* Website: http://frankbriody.com
* Twitter: @frankbriody
* LinkedIn: https://www.linkedin.com/in/frank-briody-910700199